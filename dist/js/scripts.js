document.querySelector("header").style.paddingTop=document.querySelector(".header-line").getBoundingClientRect().height+"px";let header=document.querySelector(".header-line"),burger=document.querySelector(".burger");function menuToggle(e){e.preventDefault(),header.classList.toggle("active-header"),burger.classList.toggle("active-burger")}burger.onclick=menuToggle;let phone=document.querySelector(".phone-soc"),phoneSvg=document.querySelector(".phone-soc > a");function checkPhone(e){phoneSvg.closest(".phone-soc").classList.contains("active-phone")||e.preventDefault()}function phoneClick(e){phone.classList.contains("active-phone")&&e.target!=this||phone.classList.toggle("active-phone"),phoneClose(event)}function phoneClose(e){e.target==phone||phone.contains(e.target)||phone.classList.remove("active-phone")}phoneSvg.onclick=checkPhone,phone.onclick=phoneClick,document.body.onclick=phoneClose;let deletedImg,deletedNavImg,left=document.querySelector(".arr-left"),right=document.querySelector(".arr-right"),sliderLine=document.querySelector(".slider-line"),img=document.querySelectorAll(".slider-line div"),imgArr=[],imgNumber=0,sliderNav=document.querySelector(".navigation-line"),navContent=" ";left.onclick=slideLeft,right.onclick=slideRight;for(let e=0;e<img.length;e++)img[e].setAttribute("data-picture-number",e)," "==sliderNav.innerHTML?(sliderNav.innerHTML=""+img[e].outerHTML,navContent=sliderNav.innerHTML):(sliderNav.innerHTML=`${navContent}${img[e].outerHTML}`,navContent=sliderNav.innerHTML);let navSlide=document.querySelectorAll(".navigation-line div"),navSlideWidth=navSlide[0].getBoundingClientRect().width;if(document.body.offsetWidth>990){navSlide[2].classList.add("active-slide");for(let e=0;e<img.length;e++)img[e].style.transform=`translateX(-${2*img[1].getBoundingClientRect().width}px)`}else{navSlide[1].classList.add("active-slide");for(let e=0;e<img.length;e++)img[e].style.transform=`translateX(-${img[1].getBoundingClientRect().width}px)`}function slideLeft(e){let t=document.querySelectorAll(".slider-line div"),l=document.querySelectorAll(".navigation-line div");e.preventDefault(),deletedImg=t[t.length-1],sliderLine.removeChild(t[t.length-1]),sliderLine.insertBefore(deletedImg,sliderLine.firstElementChild),deletedNavImg=l[l.length-1],sliderNav.removeChild(l[l.length-1]),sliderNav.insertBefore(deletedNavImg,sliderNav.firstElementChild)}function slideRight(e){let t=document.querySelectorAll(".slider-line div"),l=document.querySelectorAll(".navigation-line div");e.preventDefault(),deletedImg=t[0],sliderLine.removeChild(t[0]),sliderLine.appendChild(deletedImg),deletedNavImg=l[0],sliderNav.removeChild(l[0]),sliderNav.appendChild(deletedNavImg)}for(let e=0;e<navSlide.length;e++)navSlide[e].onclick=widthCheck;function widthCheck(){document.body.offsetWidth>990?goToSlide(event,2):goToSlide(event,1)}function goToSlide(e,t){console.log(t);let l=document.querySelector(".navigation-line .active-slide"),n=document.querySelectorAll(".slider-line div"),i=document.querySelectorAll(".navigation-line div");l.classList.remove("active-slide"),e.target.closest("div").classList.add("active-slide");for(let e=0;e<i.length;e++)n[e].setAttribute("data-picture-number",e),i[e].setAttribute("data-picture-number",e);if(e.target.closest("div").getAttribute("data-picture-number")>l.getAttribute("data-picture-number"))for(let l=t;l<e.target.closest("div").getAttribute("data-picture-number");l++){let e=document.querySelectorAll(".slider-line div"),t=document.querySelectorAll(".navigation-line div");deletedImg=e[0],sliderLine.removeChild(e[0]),sliderLine.appendChild(deletedImg),deletedNavImg=t[0],sliderNav.removeChild(t[0]),sliderNav.appendChild(deletedNavImg)}else{if(!(e.target.closest("div").getAttribute("data-picture-number")<l.getAttribute("data-picture-number")))return!1;for(let l=t;l>e.target.closest("div").getAttribute("data-picture-number");l--){let e=document.querySelectorAll(".slider-line div"),t=document.querySelectorAll(".navigation-line div");deletedImg=e[e.length-1],sliderLine.removeChild(e[e.length-1]),sliderLine.insertBefore(deletedImg,sliderLine.firstElementChild),deletedNavImg=t[t.length-1],sliderNav.removeChild(t[t.length-1]),sliderNav.insertBefore(deletedNavImg,sliderNav.firstElementChild)}}}let animParent=document.querySelectorAll(".anim-parent"),startAnim=window.innerHeight/2;function checkScroll(){console.log(startAnim),animParent.forEach(e=>{if(window.pageYOffset+startAnim>=e.offsetTop){let t=e.querySelectorAll(".animation-left"),l=e.querySelectorAll(".animation-right"),n=e.querySelectorAll(".animation-bottom"),i=e.querySelectorAll(".animation-fade");t.forEach(e=>{e.classList.remove("animation-left")}),l.forEach(e=>{e.classList.remove("animation-right")}),n.forEach(e=>{e.classList.remove("animation-bottom")}),i.forEach(e=>{e.classList.remove("animation-fade")})}})}window.onwheel=checkScroll,window.onscroll=checkScroll,window.ontouchmove=checkScroll;let sectionAbout=document.querySelector(".about-us"),sectionServices=document.querySelector(".services"),sectionWorks=document.querySelector(".examples"),sectionContacts=document.querySelector("footer"),offset=window.pageYOffset;function scrollDown(e){header.classList.remove("active-header"),burger.classList.remove("active-burger"),offset>e.offsetTop-40?offset-=20:offset+=20,window.scrollTo(0,offset),(offset<e.offsetTop-60||offset>e.offsetTop-20)&&setTimeout(()=>{scrollDown(e)},.3)}function aboutScroll(e){e.preventDefault(),scrollDown(sectionAbout)}function servicesScroll(e){e.preventDefault(),scrollDown(sectionServices)}function examplesScroll(e){e.preventDefault(),scrollDown(sectionWorks)}function contactsScroll(e){e.preventDefault(),scrollDown(sectionContacts)}document.querySelectorAll("#about-us").forEach(e=>{e.onclick=aboutScroll}),document.querySelectorAll("#services").forEach(e=>{e.onclick=servicesScroll}),document.querySelectorAll("#examples").forEach(e=>{e.onclick=examplesScroll}),document.querySelectorAll("#contacts").forEach(e=>{e.onclick=contactsScroll}),(()=>{const e=document.querySelectorAll(".last-line"),t=()=>{e.forEach(e=>{(e=>{const t=e.innerText.trim().split(" ");let l="";t.forEach(e=>{l+=`<span>${e} </span>`});const n=e;n.innerHTML=l;const i=Array.from(e.getElementsByTagName("span"));let o=0;i.forEach(e=>{const t=e.offsetTop;t===o||(i.forEach(e=>{e.classList.remove("last-line-element")}),o=t),e.classList.add("last-line-element")});const r=n.querySelectorAll(".last-line-element"),c=document.createElement("span");c.classList.add("last-line-row"),((e,t,l)=>{const n=e[0].parentNode,{previousSibling:i}=e[0];for(let l=0;e.length-l;t.firstChild===e[0]&&(l+=1))t.appendChild(e[l]);i?n.insertBefore(t,i.nextSibling):l.appendChild(t)})(r,c,e)})(e)})};window.addEventListener("resize",()=>{t()}),t()})();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMuanMiXSwibmFtZXMiOlsiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwic3R5bGUiLCJwYWRkaW5nVG9wIiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwiaGVpZ2h0IiwiaGVhZGVyIiwiYnVyZ2VyIiwibWVudVRvZ2dsZSIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJvbmNsaWNrIiwicGhvbmUiLCJwaG9uZVN2ZyIsImNoZWNrUGhvbmUiLCJlIiwiY2xvc2VzdCIsImNvbnRhaW5zIiwicGhvbmVDbGljayIsInRhcmdldCIsInRoaXMiLCJwaG9uZUNsb3NlIiwicmVtb3ZlIiwiYm9keSIsImRlbGV0ZWRJbWciLCJkZWxldGVkTmF2SW1nIiwibGVmdCIsInJpZ2h0Iiwic2xpZGVyTGluZSIsImltZyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbWdBcnIiLCJpbWdOdW1iZXIiLCJzbGlkZXJOYXYiLCJuYXZDb250ZW50Iiwic2xpZGVMZWZ0Iiwic2xpZGVSaWdodCIsImkiLCJsZW5ndGgiLCJzZXRBdHRyaWJ1dGUiLCJpbm5lckhUTUwiLCJvdXRlckhUTUwiLCJuYXZTbGlkZSIsIm5hdlNsaWRlV2lkdGgiLCJ3aWR0aCIsIm9mZnNldFdpZHRoIiwiYWRkIiwidHJhbnNmb3JtIiwicmVtb3ZlQ2hpbGQiLCJpbnNlcnRCZWZvcmUiLCJmaXJzdEVsZW1lbnRDaGlsZCIsImFwcGVuZENoaWxkIiwid2lkdGhDaGVjayIsImdvVG9TbGlkZSIsIm1pZGRsZVNsaWRlIiwiY29uc29sZSIsImxvZyIsImFjdGl2ZVNsaWRlIiwiYSIsImdldEF0dHJpYnV0ZSIsImMiLCJhbmltUGFyZW50Iiwic3RhcnRBbmltIiwid2luZG93IiwiaW5uZXJIZWlnaHQiLCJjaGVja1Njcm9sbCIsImZvckVhY2giLCJwYWdlWU9mZnNldCIsIm9mZnNldFRvcCIsImFuaW1MZWZ0IiwiYW5pbVJpZ2h0IiwiYW5pbUJvdHRvbSIsImFuaW1GYWRlIiwiZWxlbSIsIm9ud2hlZWwiLCJvbnNjcm9sbCIsIm9udG91Y2htb3ZlIiwic2VjdGlvbkFib3V0Iiwic2VjdGlvblNlcnZpY2VzIiwic2VjdGlvbldvcmtzIiwic2VjdGlvbkNvbnRhY3RzIiwib2Zmc2V0Iiwic2Nyb2xsRG93biIsInNlY3Rpb24iLCJzY3JvbGxUbyIsInNldFRpbWVvdXQiLCJhYm91dFNjcm9sbCIsInNlcnZpY2VzU2Nyb2xsIiwiZXhhbXBsZXNTY3JvbGwiLCJjb250YWN0c1Njcm9sbCIsImVsZW1lbnRzIiwiZmluZExhc3RSb3dzIiwiY29udGVudEFyciIsImlubmVyVGV4dCIsInRyaW0iLCJzcGxpdCIsImNvbnRlbnRGb3JtYXR0ZWQiLCJpdGVtIiwiZWxlbWVudCIsImNoaWxkcmVuU3BhbiIsIkFycmF5IiwiZnJvbSIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwidG9wIiwidGhpc1RvcCIsImVsIiwid3JhcEVsZW1lbnRzIiwid3JhcHBlciIsImNyZWF0ZUVsZW1lbnQiLCJub2RlcyIsInBhcmVudCIsInBhcmVudE5vZGUiLCJwcmV2aW91c1NpYmxpbmciLCJmaXJzdENoaWxkIiwibmV4dFNpYmxpbmciLCJ3cmFwQWxsIiwiZmluZExhc3RSb3ciLCJhZGRFdmVudExpc3RlbmVyIl0sIm1hcHBpbmdzIjoiQUFBQUEsU0FBU0MsY0FBYyxVQUFVQyxNQUFNQyxXQUFnQkgsU0FBU0MsY0FBYyxnQkFBZ0JHLHdCQUF3QkMsT0FBbEUsS0FHcEQsSUFBSUMsT0FBU04sU0FBU0MsY0FBYyxnQkFDaENNLE9BQVNQLFNBQVNDLGNBQWMsV0FJcEMsU0FBU08sV0FBWUMsR0FDbkJBLEVBQU1DLGlCQUNOSixPQUFPSyxVQUFVQyxPQUFPLGlCQUN4QkwsT0FBT0ksVUFBVUMsT0FBTyxpQkFMMUJMLE9BQU9NLFFBQVVMLFdBVWpCLElBQUlNLE1BQVFkLFNBQVNDLGNBQWMsY0FDL0JjLFNBQVdmLFNBQVNDLGNBQWMsa0JBSXRDLFNBQVNlLFdBQVlDLEdBQ2ZGLFNBQVNHLFFBQVEsY0FBY1AsVUFB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RCxJQUdkSixFQUFhakMsUUFBU3VDLElBQ3BCQSxFQUFHaEcsVUFBVWEsT0FuQ0QsdUJBcUNkaUYsRUFBTUMsR0FMTlAsRUFBS3hGLFVBQVVxQyxJQWhDRCx1QkEwQ2xCLE1BQU00RCxFQUFlUixFQUFRcEUsaUJBQWlCLHNCQUN4QzZFLEVBQVU3RyxTQUFTOEcsY0FBYyxRQUN2Q0QsRUFBUWxHLFVBQVVxQyxJQTNDSixpQkFFQSxFQUFDK0QsRUFBT0YsRUFBU2xDLEtBQy9CLE1BQU1xQyxFQUFTRCxFQUFNLEdBQUdFLFlBQ2xCQyxnQkFBRUEsR0FBb0JILEVBQU0sR0FDbEMsSUFBSyxJQUFJeEUsRUFBSSxFQUFHd0UsRUFBTXZFLE9BQVNELEVBQUdzRSxFQUFRTSxhQUFlSixFQUFNLEtBQU94RSxHQUFLLEdBQ3pFc0UsRUFBUXhELFlBQVkwRCxFQUFNeEUsSUFFeEIyRSxFQUNGRixFQUFPN0QsYUFBYTBELEVBQVNLLEVBQWdCRSxhQUU3Q3pDLEVBQUt0QixZQUFZd0QsSUFpQ25CUSxDQUFRVCxFQUFjQyxFQUFTbEMsSUFLN0IyQyxDQUFZM0MsTUFJaEJWLE9BQU9zRCxpQkFBaUIsU0FBVSxLQUNoQzFCLE1BRUZBLEtBM0RGIiwiZmlsZSI6InNjcmlwdHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiaGVhZGVyXCIpLnN0eWxlLnBhZGRpbmdUb3AgPSBgJHtkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmhlYWRlci1saW5lXCIpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodH1weGBcblxuLy9idXJnZXIgbWVudSBcbmxldCBoZWFkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmhlYWRlci1saW5lXCIpLFxuICAgIGJ1cmdlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYnVyZ2VyXCIpXG5cbmJ1cmdlci5vbmNsaWNrID0gbWVudVRvZ2dsZSBcblxuZnVuY3Rpb24gbWVudVRvZ2dsZSAoZXZlbnQpe1xuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpXG4gIGhlYWRlci5jbGFzc0xpc3QudG9nZ2xlKFwiYWN0aXZlLWhlYWRlclwiKVxuICBidXJnZXIuY2xhc3NMaXN0LnRvZ2dsZShcImFjdGl2ZS1idXJnZXJcIilcbn1cblxuLy9waG9uZSBvbiBzb2MgbGluZSB0b2dnbGUgXG5cbmxldCBwaG9uZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGhvbmUtc29jXCIpLFxuICAgIHBob25lU3ZnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5waG9uZS1zb2MgPiBhXCIpXG5cbnBob25lU3ZnLm9uY2xpY2sgPSBjaGVja1Bob25lXG5cbmZ1bmN0aW9uIGNoZWNrUGhvbmUgKGUpe1xuICBpZighcGhvbmVTdmcuY2xvc2VzdChcIi5waG9uZS1zb2NcIikuY2xhc3NMaXN0LmNvbnRhaW5zKFwiYWN0aXZlLXBob25lXCIpKXtcbiAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgfVxufVxuXG5waG9uZS5vbmNsaWNrID0gcGhvbmVDbGlja1xuXG5mdW5jdGlvbiBwaG9uZUNsaWNrIChlKXtcbiAgaWYocGhvbmUuY2xhc3NMaXN0LmNvbnRhaW5zKFwiYWN0aXZlLXBob25lXCIpICYmIGUudGFyZ2V0ICE9IHRoaXMpe1xuICB9ZWxzZXtcbiAgICBwaG9uZS5jbGFzc0xpc3QudG9nZ2xlKFwiYWN0aXZlLXBob25lXCIpXG4gIH1cbiAgcGhvbmVDbG9zZShldmVudClcbn1cblxuZG9jdW1lbnQuYm9keS5vbmNsaWNrID0gcGhvbmVDbG9zZVxuXG5mdW5jdGlvbiBwaG9uZUNsb3NlIChldmVudCl7XG4gIGlmKGV2ZW50LnRhcmdldCAhPSBwaG9uZSAmJiAhcGhvbmUuY29udGFpbnMoZXZlbnQudGFyZ2V0KSl7XG4gICAgcGhvbmUuY2xhc3NMaXN0LnJlbW92ZShcImFjdGl2ZS1waG9uZVwiKVxuICB9XG59XG5cbi8vIGdhbGxlcnkgc2xpZGVyIFxubGV0IGxlZnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFyci1sZWZ0XCIpLFxuICAgIHJpZ2h0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hcnItcmlnaHRcIiksXG4gICAgc2xpZGVyTGluZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2xpZGVyLWxpbmVcIiksXG4gICAgaW1nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5zbGlkZXItbGluZSBkaXZcIiksXG4gICAgaW1nQXJyID0gW10sXG4gICAgaW1nTnVtYmVyID0gMCxcbiAgICBzbGlkZXJOYXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm5hdmlnYXRpb24tbGluZVwiKSxcbiAgICBuYXZDb250ZW50ID0gXCIgXCIsXG4gICAgZGVsZXRlZEltZyxcbiAgICBkZWxldGVkTmF2SW1nXG5cbmxlZnQub25jbGljayA9IHNsaWRlTGVmdCBcbnJpZ2h0Lm9uY2xpY2sgPSBzbGlkZVJpZ2h0IFxuXG5mb3IobGV0IGkgPSAwOyBpIDwgaW1nLmxlbmd0aDsgaSsrKXtcbiAgaW1nW2ldLnNldEF0dHJpYnV0ZShcImRhdGEtcGljdHVyZS1udW1iZXJcIiwgaSlcbiAgaWYoc2xpZGVyTmF2LmlubmVySFRNTCA9PSBcIiBcIil7XG4gICAgc2xpZGVyTmF2LmlubmVySFRNTCA9IGAke2ltZ1tpXS5vdXRlckhUTUx9YFxuICAgIG5hdkNvbnRlbnQgPSBzbGlkZXJOYXYuaW5uZXJIVE1MXG4gIH1lbHNle1xuICAgIHNsaWRlck5hdi5pbm5lckhUTUwgPSBgJHtuYXZDb250ZW50fSR7aW1nW2ldLm91dGVySFRNTH1gXG4gICAgbmF2Q29udGVudCA9IHNsaWRlck5hdi5pbm5lckhUTUxcbiAgfVxufVxuXG5cbmxldCBuYXZTbGlkZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubmF2aWdhdGlvbi1saW5lIGRpdlwiKSxcbm5hdlNsaWRlV2lkdGggPSBuYXZTbGlkZVswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aFxuICAgIFxuaWYoZG9jdW1lbnQuYm9keS5vZmZzZXRXaWR0aCA+IDk5MCl7XG4gIG5hdlNsaWRlWzJdLmNsYXNzTGlzdC5hZGQoXCJhY3RpdmUtc2xpZGVcIikgIFxuICBmb3IobGV0IGkgPSAwOyBpIDwgaW1nLmxlbmd0aDsgaSsrKXtcbiAgICBpbWdbaV0uc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoLSR7aW1nWzFdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoICogMn1weClgXG4gIH1cbn1lbHNle1xuICBuYXZTbGlkZVsxXS5jbGFzc0xpc3QuYWRkKFwiYWN0aXZlLXNsaWRlXCIpICBcbiAgZm9yKGxldCBpID0gMDsgaSA8IGltZy5sZW5ndGg7IGkrKyl7XG4gICAgaW1nW2ldLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGVYKC0ke2ltZ1sxXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aH1weClgIFxuICB9XG59XG5cbmZ1bmN0aW9uIHNsaWRlTGVmdCAoZXZlbnQpe1xuICBsZXQgaW1nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5zbGlkZXItbGluZSBkaXZcIiksXG4gICAgICBuYXZTbGlkZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubmF2aWdhdGlvbi1saW5lIGRpdlwiKVxuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpXG4gIGRlbGV0ZWRJbWcgPSBpbWdbaW1nLmxlbmd0aCAtIDFdXG4gIHNsaWRlckxpbmUucmVtb3ZlQ2hpbGQoaW1nW2ltZy5sZW5ndGggLSAxXSlcbiAgc2xpZGVyTGluZS5pbnNlcnRCZWZvcmUoZGVsZXRlZEltZywgc2xpZGVyTGluZS5maXJzdEVsZW1lbnRDaGlsZClcbiAgZGVsZXRlZE5hdkltZyA9IG5hdlNsaWRlW25hdlNsaWRlLmxlbmd0aCAtIDFdXG4gIHNsaWRlck5hdi5yZW1vdmVDaGlsZChuYXZTbGlkZVtuYXZTbGlkZS5sZW5ndGggLSAxXSlcbiAgc2xpZGVyTmF2Lmluc2VydEJlZm9yZShkZWxldGVkTmF2SW1nLCBzbGlkZXJOYXYuZmlyc3RFbGVtZW50Q2hpbGQpXG59XG5cbmZ1bmN0aW9uIHNsaWRlUmlnaHQgKGV2ZW50KXtcbiAgbGV0IGltZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc2xpZGVyLWxpbmUgZGl2XCIpLFxuICAgICAgbmF2U2xpZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm5hdmlnYXRpb24tbGluZSBkaXZcIilcbiAgZXZlbnQucHJldmVudERlZmF1bHQoKVxuICBkZWxldGVkSW1nID0gaW1nWzBdXG4gIHNsaWRlckxpbmUucmVtb3ZlQ2hpbGQoaW1nWzBdKVxuICBzbGlkZXJMaW5lLmFwcGVuZENoaWxkKGRlbGV0ZWRJbWcpXG4gIGRlbGV0ZWROYXZJbWcgPSBuYXZTbGlkZVswXVxuICBzbGlkZXJOYXYucmVtb3ZlQ2hpbGQobmF2U2xpZGVbMF0pXG4gIHNsaWRlck5hdi5hcHBlbmRDaGlsZChkZWxldGVkTmF2SW1nKVxufVxuXG5mb3IobGV0IGkgPSAwOyBpIDwgbmF2U2xpZGUubGVuZ3RoOyBpKyspe1xuICBuYXZTbGlkZVtpXS5vbmNsaWNrID0gd2lkdGhDaGVja1xufVxuXG5mdW5jdGlvbiB3aWR0aENoZWNrICgpe1xuICBpZihkb2N1bWVudC5ib2R5Lm9mZnNldFdpZHRoID4gOTkwKXtcbiAgICBnb1RvU2xpZGUoZXZlbnQsIDIpXG4gIH1lbHNle1xuICAgIGdvVG9TbGlkZShldmVudCwgMSlcbiAgfVxufVxuXG5mdW5jdGlvbiBnb1RvU2xpZGUgKGV2ZW50LCBtaWRkbGVTbGlkZSl7XG4gIGNvbnNvbGUubG9nKG1pZGRsZVNsaWRlKVxuICBsZXQgYWN0aXZlU2xpZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAubmF2aWdhdGlvbi1saW5lIC5hY3RpdmUtc2xpZGVgKSxcbiAgICAgIGltZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc2xpZGVyLWxpbmUgZGl2XCIpLFxuICAgICAgbmF2U2xpZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm5hdmlnYXRpb24tbGluZSBkaXZcIilcbiAgYWN0aXZlU2xpZGUuY2xhc3NMaXN0LnJlbW92ZShcImFjdGl2ZS1zbGlkZVwiKSAgXG4gIGV2ZW50LnRhcmdldC5jbG9zZXN0KFwiZGl2XCIpLmNsYXNzTGlzdC5hZGQoXCJhY3RpdmUtc2xpZGVcIikgXG4gIGZvcihsZXQgYSA9IDA7IGEgPCBuYXZTbGlkZS5sZW5ndGg7IGErKyl7XG4gICAgaW1nW2FdLnNldEF0dHJpYnV0ZShcImRhdGEtcGljdHVyZS1udW1iZXJcIiwgYSlcbiAgICBuYXZTbGlkZVthXS5zZXRBdHRyaWJ1dGUoXCJkYXRhLXBpY3R1cmUtbnVtYmVyXCIsIGEpXG4gIH0gIFxuICBpZihldmVudC50YXJnZXQuY2xvc2VzdChcImRpdlwiKS5nZXRBdHRyaWJ1dGUoXCJkYXRhLXBpY3R1cmUtbnVtYmVyXCIpID4gYWN0aXZlU2xpZGUuZ2V0QXR0cmlidXRlKFwiZGF0YS1waWN0dXJlLW51bWJlclwiKSl7XG4gICAgZm9yKGxldCBjID0gbWlkZGxlU2xpZGU7IGMgPCBldmVudC50YXJnZXQuY2xvc2VzdChcImRpdlwiKS5nZXRBdHRyaWJ1dGUoXCJkYXRhLXBpY3R1cmUtbnVtYmVyXCIpOyBjKyspe1xuICAgICAgbGV0IGltZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc2xpZGVyLWxpbmUgZGl2XCIpLFxuICAgICAgICAgIG5hdlNsaWRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5uYXZpZ2F0aW9uLWxpbmUgZGl2XCIpXG4gICAgICBkZWxldGVkSW1nID0gaW1nWzBdXG4gICAgICBzbGlkZXJMaW5lLnJlbW92ZUNoaWxkKGltZ1swXSlcbiAgICAgIHNsaWRlckxpbmUuYXBwZW5kQ2hpbGQoZGVsZXRlZEltZylcbiAgICAgIGRlbGV0ZWROYXZJbWcgPSBuYXZTbGlkZVswXVxuICAgICAgc2xpZGVyTmF2LnJlbW92ZUNoaWxkKG5hdlNsaWRlWzBdKVxuICAgICAgc2xpZGVyTmF2LmFwcGVuZENoaWxkKGRlbGV0ZWROYXZJbWcpXG4gICAgfVxuICB9ZWxzZSBpZihldmVudC50YXJnZXQuY2xvc2VzdChcImRpdlwiKS5nZXRBdHRyaWJ1dGUoXCJkYXRhLXBpY3R1cmUtbnVtYmVyXCIpIDwgYWN0aXZlU2xpZGUuZ2V0QXR0cmlidXRlKFwiZGF0YS1waWN0dXJlLW51bWJlclwiKSl7XG4gICAgZm9yKGxldCBjID0gbWlkZGxlU2xpZGU7IGMgPiBldmVudC50YXJnZXQuY2xvc2VzdChcImRpdlwiKS5nZXRBdHRyaWJ1dGUoXCJkYXRhLXBpY3R1cmUtbnVtYmVyXCIpOyBjLS0pe1xuICAgICAgbGV0IGltZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc2xpZGVyLWxpbmUgZGl2XCIpLFxuICAgICAgICAgIG5hdlNsaWRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5uYXZpZ2F0aW9uLWxpbmUgZGl2XCIpXG4gICAgICBkZWxldGVkSW1nID0gaW1nW2ltZy5sZW5ndGggLSAxXVxuICAgICAgc2xpZGVyTGluZS5yZW1vdmVDaGlsZChpbWdbaW1nLmxlbmd0aCAtIDFdKVxuICAgICAgc2xpZGVyTGluZS5pbnNlcnRCZWZvcmUoZGVsZXRlZEltZywgc2xpZGVyTGluZS5maXJzdEVsZW1lbnRDaGlsZClcbiAgICAgIGRlbGV0ZWROYXZJbWcgPSBuYXZTbGlkZVtuYXZTbGlkZS5sZW5ndGggLSAxXVxuICAgICAgc2xpZGVyTmF2LnJlbW92ZUNoaWxkKG5hdlNsaWRlW25hdlNsaWRlLmxlbmd0aCAtIDFdKVxuICAgICAgc2xpZGVyTmF2Lmluc2VydEJlZm9yZShkZWxldGVkTmF2SW1nLCBzbGlkZXJOYXYuZmlyc3RFbGVtZW50Q2hpbGQpXG4gICAgfVxuICB9ZWxzZXtcbiAgICByZXR1cm4gZmFsc2VcbiAgfVxufVxuXG4vLyBzY3JvbGwgYW5pbWF0aW9uc1xuXG5sZXQgYW5pbVBhcmVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYW5pbS1wYXJlbnRcIiksXG4gICAgc3RhcnRBbmltID0gd2luZG93LmlubmVySGVpZ2h0LzJcblxud2luZG93Lm9ud2hlZWwgPSBjaGVja1Njcm9sbFxud2luZG93Lm9uc2Nyb2xsID0gY2hlY2tTY3JvbGxcbndpbmRvdy5vbnRvdWNobW92ZSA9IGNoZWNrU2Nyb2xsXG4gICAgXG5mdW5jdGlvbiBjaGVja1Njcm9sbCAoKXtcbiAgY29uc29sZS5sb2coc3RhcnRBbmltKVxuICBhbmltUGFyZW50LmZvckVhY2goKGUpID0+IHtcbiAgICBpZih3aW5kb3cucGFnZVlPZmZzZXQgKyBzdGFydEFuaW0gPj0gZS5vZmZzZXRUb3Ape1xuICAgICAgbGV0IGFuaW1MZWZ0ID0gZS5xdWVyeVNlbGVjdG9yQWxsKFwiLmFuaW1hdGlvbi1sZWZ0XCIpLFxuICAgICAgICAgIGFuaW1SaWdodCA9IGUucXVlcnlTZWxlY3RvckFsbChcIi5hbmltYXRpb24tcmlnaHRcIiksXG4gICAgICAgICAgYW5pbUJvdHRvbSA9IGUucXVlcnlTZWxlY3RvckFsbChcIi5hbmltYXRpb24tYm90dG9tXCIpLFxuICAgICAgICAgIGFuaW1GYWRlID0gZS5xdWVyeVNlbGVjdG9yQWxsKFwiLmFuaW1hdGlvbi1mYWRlXCIpXG4gICAgICBhbmltTGVmdC5mb3JFYWNoKChlbGVtKT0+e1xuICAgICAgICBlbGVtLmNsYXNzTGlzdC5yZW1vdmUoXCJhbmltYXRpb24tbGVmdFwiKSAgXG4gICAgICB9KVxuICAgICAgYW5pbVJpZ2h0LmZvckVhY2goKGVsZW0pPT57XG4gICAgICAgIGVsZW0uY2xhc3NMaXN0LnJlbW92ZShcImFuaW1hdGlvbi1yaWdodFwiKSAgXG4gICAgICB9KVxuICAgICAgYW5pbUJvdHRvbS5mb3JFYWNoKChlbGVtKT0+e1xuICAgICAgICBlbGVtLmNsYXNzTGlzdC5yZW1vdmUoXCJhbmltYXRpb24tYm90dG9tXCIpICBcbiAgICAgIH0pXG4gICAgICBhbmltRmFkZS5mb3JFYWNoKChlbGVtKT0+e1xuICAgICAgICBlbGVtLmNsYXNzTGlzdC5yZW1vdmUoXCJhbmltYXRpb24tZmFkZVwiKSAgXG4gICAgICB9KVxuICAgIH1cbiAgfSkgIFxufVxuXG4vL2hlYWRlciBzY3JvbGwgdG8gXG5cbmxldCBzZWN0aW9uQWJvdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFib3V0LXVzXCIpLFxuICAgIHNlY3Rpb25TZXJ2aWNlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2VydmljZXNcIiksXG4gICAgc2VjdGlvbldvcmtzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5leGFtcGxlc1wiKSxcbiAgICBzZWN0aW9uQ29udGFjdHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiZm9vdGVyXCIpLFxuICAgIG9mZnNldCA9IHdpbmRvdy5wYWdlWU9mZnNldFxuICAgIFxuZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIiNhYm91dC11c1wiKS5mb3JFYWNoKChlKT0+e1xuICBlLm9uY2xpY2sgPSBhYm91dFNjcm9sbFxuXG59KVxuZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIiNzZXJ2aWNlc1wiKS5mb3JFYWNoKChlKT0+e1xuICBlLm9uY2xpY2sgPSBzZXJ2aWNlc1Njcm9sbFxuXG59KVxuZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIiNleGFtcGxlc1wiKS5mb3JFYWNoKChlKT0+e1xuICBlLm9uY2xpY2sgPSBleGFtcGxlc1Njcm9sbFxuXG59KVxuZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIiNjb250YWN0c1wiKS5mb3JFYWNoKChlKT0+e1xuICBlLm9uY2xpY2sgPSBjb250YWN0c1Njcm9sbFxuXG59KVxuXG5mdW5jdGlvbiBzY3JvbGxEb3duIChzZWN0aW9uKXtcbiAgaGVhZGVyLmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmUtaGVhZGVyXCIpXG4gIGJ1cmdlci5jbGFzc0xpc3QucmVtb3ZlKFwiYWN0aXZlLWJ1cmdlclwiKVxuICBpZihvZmZzZXQgPiBzZWN0aW9uLm9mZnNldFRvcCAtIDQwKXtcbiAgICBvZmZzZXQgPSBvZmZzZXQgLSAyMFxuICB9ZWxzZXtcbiAgICBvZmZzZXQgPSBvZmZzZXQgKyAyMFxuICB9XG4gIHdpbmRvdy5zY3JvbGxUbygwLCBvZmZzZXQpXG4gIGlmKG9mZnNldCA8IHNlY3Rpb24ub2Zmc2V0VG9wIC0gNjAgfHwgb2Zmc2V0ID4gc2VjdGlvbi5vZmZzZXRUb3AgLSAyMCl7XG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBzY3JvbGxEb3duIChzZWN0aW9uKVxuICAgIH0sIDAuMylcbiAgfVxufVxuXG5mdW5jdGlvbiBhYm91dFNjcm9sbChlKXtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gIHNjcm9sbERvd24oc2VjdGlvbkFib3V0KVxufVxuZnVuY3Rpb24gc2VydmljZXNTY3JvbGwoZSl7XG4gIGUucHJldmVudERlZmF1bHQoKVxuICBzY3JvbGxEb3duKHNlY3Rpb25TZXJ2aWNlcylcbn1cbmZ1bmN0aW9uIGV4YW1wbGVzU2Nyb2xsKGUpe1xuICBlLnByZXZlbnREZWZhdWx0KClcbiAgc2Nyb2xsRG93bihzZWN0aW9uV29ya3MpXG59XG5mdW5jdGlvbiBjb250YWN0c1Njcm9sbChlKXtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gIHNjcm9sbERvd24oc2VjdGlvbkNvbnRhY3RzKVxufVxuXG4vLyB0aXRsZXMgbGF0cyBsaW5lIHVuZGVybGluZVxuXG4oKCkgPT4ge1xuICBjb25zdCBlbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5sYXN0LWxpbmUnKVxuICBjb25zdCBuYW1lRWxlbWVudCA9ICdsYXN0LWxpbmUtZWxlbWVudCdcbiAgY29uc3QgbmFtZVJvdyA9ICdsYXN0LWxpbmUtcm93J1xuXG4gIGNvbnN0IHdyYXBBbGwgPSAobm9kZXMsIHdyYXBwZXIsIGVsZW0pID0+IHtcbiAgICBjb25zdCBwYXJlbnQgPSBub2Rlc1swXS5wYXJlbnROb2RlXG4gICAgY29uc3QgeyBwcmV2aW91c1NpYmxpbmcgfSA9IG5vZGVzWzBdXG4gICAgZm9yIChsZXQgaSA9IDA7IG5vZGVzLmxlbmd0aCAtIGk7IHdyYXBwZXIuZmlyc3RDaGlsZCA9PT0gbm9kZXNbMF0gJiYgKGkgKz0gMSkpIHtcbiAgICAgIHdyYXBwZXIuYXBwZW5kQ2hpbGQobm9kZXNbaV0pXG4gICAgfVxuICAgIGlmIChwcmV2aW91c1NpYmxpbmcpIHtcbiAgICAgIHBhcmVudC5pbnNlcnRCZWZvcmUod3JhcHBlciwgcHJldmlvdXNTaWJsaW5nLm5leHRTaWJsaW5nKVxuICAgIH0gZWxzZSB7XG4gICAgICBlbGVtLmFwcGVuZENoaWxkKHdyYXBwZXIpXG4gICAgfVxuICAgIHJldHVybiB3cmFwcGVyXG4gIH1cblxuICBjb25zdCBmaW5kTGFzdFJvdyA9IChlbGVtKSA9PiB7XG4gICAgY29uc3QgY29udGVudCA9IGVsZW0uaW5uZXJUZXh0LnRyaW0oKVxuICAgIGNvbnN0IGNvbnRlbnRBcnIgPSBjb250ZW50LnNwbGl0KCcgJylcbiAgICBsZXQgY29udGVudEZvcm1hdHRlZCA9ICcnXG4gICAgY29udGVudEFyci5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICBjb250ZW50Rm9ybWF0dGVkICs9IGA8c3Bhbj4ke2l0ZW19IDwvc3Bhbj5gXG4gICAgfSlcbiAgICBjb25zdCBlbGVtZW50ID0gZWxlbVxuICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gY29udGVudEZvcm1hdHRlZFxuXG4gICAgY29uc3QgY2hpbGRyZW5TcGFuID0gQXJyYXkuZnJvbShlbGVtLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdzcGFuJykpXG4gICAgbGV0IHRvcCA9IDBcbiAgICBjaGlsZHJlblNwYW4uZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgY29uc3QgdGhpc1RvcCA9IGl0ZW0ub2Zmc2V0VG9wXG4gICAgICBpZiAodGhpc1RvcCA9PT0gdG9wKSB7XG4gICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZChuYW1lRWxlbWVudClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNoaWxkcmVuU3Bhbi5mb3JFYWNoKChlbCkgPT4ge1xuICAgICAgICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUobmFtZUVsZW1lbnQpXG4gICAgICAgIH0pXG4gICAgICAgIHRvcCA9IHRoaXNUb3BcbiAgICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKG5hbWVFbGVtZW50KVxuICAgICAgfVxuICAgIH0pXG5cbiAgICBjb25zdCB3cmFwRWxlbWVudHMgPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYC4ke25hbWVFbGVtZW50fWApXG4gICAgY29uc3Qgd3JhcHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKVxuICAgIHdyYXBwZXIuY2xhc3NMaXN0LmFkZChuYW1lUm93KVxuICAgIHdyYXBBbGwod3JhcEVsZW1lbnRzLCB3cmFwcGVyLCBlbGVtKVxuICB9XG5cbiAgY29uc3QgZmluZExhc3RSb3dzID0gKCkgPT4ge1xuICAgIGVsZW1lbnRzLmZvckVhY2goKGVsZW0pID0+IHtcbiAgICAgIGZpbmRMYXN0Um93KGVsZW0pXG4gICAgfSlcbiAgfVxuXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCAoKSA9PiB7XG4gICAgZmluZExhc3RSb3dzKClcbiAgfSlcbiAgZmluZExhc3RSb3dzKClcbn0pKCkiXX0=
